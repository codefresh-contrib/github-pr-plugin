version: '1.0'

steps:

  main_build:
    type: build
    title: "Building GitHub pull request container ..."
    description: build github pr container
    image_name: codefresh/github-pr-plugin

  push_image:
    type: push
    title: "Pushing github-pr-plugin:latest ..."
    description: Push github-pr-plugin image to the DockerHub
    candidate: ${{main_build}}
    tag: latest
    image_name: codefresh/github-pr-plugin


  github-pr:
    image: codefresh/github-pr-plugin
    environment:
      - GITHUB_REPO_OWNER=${{CF_REPO_OWNER}}
      - GITHUB_REPO_NAME=${{CF_REPO_NAME}}
      - BASE=master
      - HEAD=${{CF_BRANCH}}
      - TITLE=Codefresh PR for ${{CF_BRANCH}}
